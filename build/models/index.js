'use strict';

var fs = require('fs');
var path = require('path');
var Sequelize = require('sequelize');
var basename = path.basename(__filename);
var env = process.env.NODE_ENV || 'development';
var config = require(__dirname + '/../config/config.json')[env];
var db = {};

var sequelize = void 0;
if (config.use_env_variable) {
  sequelize = new Sequelize(process.env[config.use_env_variable], config);
} else {
  sequelize = new Sequelize(config.database, config.username, config.password, config);
}

fs.readdirSync(__dirname).filter(function (file) {
  return file.indexOf('.') !== 0 && file !== basename && file.slice(-3) === '.js';
}).forEach(function (file) {
  var model = sequelize['import'](path.join(__dirname, file));
  db[model.name] = model;
});

Object.keys(db).forEach(function (modelName) {
  if (db[modelName].associate) {
    db[modelName].associate(db);
  }
});

db.sequelize = sequelize;
db.Sequelize = Sequelize;

module.exports = db;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL21vZGVscy9pbmRleC5qcyJdLCJuYW1lcyI6WyJmcyIsInJlcXVpcmUiLCJwYXRoIiwiU2VxdWVsaXplIiwiYmFzZW5hbWUiLCJfX2ZpbGVuYW1lIiwiZW52IiwicHJvY2VzcyIsIk5PREVfRU5WIiwiY29uZmlnIiwiX19kaXJuYW1lIiwiZGIiLCJzZXF1ZWxpemUiLCJ1c2VfZW52X3ZhcmlhYmxlIiwiZGF0YWJhc2UiLCJ1c2VybmFtZSIsInBhc3N3b3JkIiwicmVhZGRpclN5bmMiLCJmaWx0ZXIiLCJmaWxlIiwiaW5kZXhPZiIsInNsaWNlIiwiZm9yRWFjaCIsIm1vZGVsIiwiam9pbiIsIm5hbWUiLCJPYmplY3QiLCJrZXlzIiwibW9kZWxOYW1lIiwiYXNzb2NpYXRlIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUEsSUFBTUEsS0FBS0MsUUFBUSxJQUFSLENBQVg7QUFDQSxJQUFNQyxPQUFPRCxRQUFRLE1BQVIsQ0FBYjtBQUNBLElBQU1FLFlBQVlGLFFBQVEsV0FBUixDQUFsQjtBQUNBLElBQU1HLFdBQVdGLEtBQUtFLFFBQUwsQ0FBY0MsVUFBZCxDQUFqQjtBQUNBLElBQU1DLE1BQU1DLFFBQVFELEdBQVIsQ0FBWUUsUUFBWixJQUF3QixhQUFwQztBQUNBLElBQU1DLFNBQVNSLFFBQVFTLFlBQVksd0JBQXBCLEVBQThDSixHQUE5QyxDQUFmO0FBQ0EsSUFBTUssS0FBSyxFQUFYOztBQUVBLElBQUlDLGtCQUFKO0FBQ0EsSUFBSUgsT0FBT0ksZ0JBQVgsRUFBNkI7QUFDM0JELGNBQVksSUFBSVQsU0FBSixDQUFjSSxRQUFRRCxHQUFSLENBQVlHLE9BQU9JLGdCQUFuQixDQUFkLEVBQW9ESixNQUFwRCxDQUFaO0FBQ0QsQ0FGRCxNQUVPO0FBQ0xHLGNBQVksSUFBSVQsU0FBSixDQUFjTSxPQUFPSyxRQUFyQixFQUErQkwsT0FBT00sUUFBdEMsRUFBZ0ROLE9BQU9PLFFBQXZELEVBQWlFUCxNQUFqRSxDQUFaO0FBQ0Q7O0FBRURULEdBQ0dpQixXQURILENBQ2VQLFNBRGYsRUFFR1EsTUFGSCxDQUVVLGdCQUFRO0FBQ2QsU0FBUUMsS0FBS0MsT0FBTCxDQUFhLEdBQWIsTUFBc0IsQ0FBdkIsSUFBOEJELFNBQVNmLFFBQXZDLElBQXFEZSxLQUFLRSxLQUFMLENBQVcsQ0FBQyxDQUFaLE1BQW1CLEtBQS9FO0FBQ0QsQ0FKSCxFQUtHQyxPQUxILENBS1csZ0JBQVE7QUFDZixNQUFNQyxRQUFRWCxVQUFVLFFBQVYsRUFBb0JWLEtBQUtzQixJQUFMLENBQVVkLFNBQVYsRUFBcUJTLElBQXJCLENBQXBCLENBQWQ7QUFDQVIsS0FBR1ksTUFBTUUsSUFBVCxJQUFpQkYsS0FBakI7QUFDRCxDQVJIOztBQVVBRyxPQUFPQyxJQUFQLENBQVloQixFQUFaLEVBQWdCVyxPQUFoQixDQUF3QixxQkFBYTtBQUNuQyxNQUFJWCxHQUFHaUIsU0FBSCxFQUFjQyxTQUFsQixFQUE2QjtBQUMzQmxCLE9BQUdpQixTQUFILEVBQWNDLFNBQWQsQ0FBd0JsQixFQUF4QjtBQUNEO0FBQ0YsQ0FKRDs7QUFNQUEsR0FBR0MsU0FBSCxHQUFlQSxTQUFmO0FBQ0FELEdBQUdSLFNBQUgsR0FBZUEsU0FBZjs7QUFFQTJCLE9BQU9DLE9BQVAsR0FBaUJwQixFQUFqQiIsImZpbGUiOiJpbmRleC5qcyIsInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcblxuY29uc3QgZnMgPSByZXF1aXJlKCdmcycpO1xuY29uc3QgcGF0aCA9IHJlcXVpcmUoJ3BhdGgnKTtcbmNvbnN0IFNlcXVlbGl6ZSA9IHJlcXVpcmUoJ3NlcXVlbGl6ZScpO1xuY29uc3QgYmFzZW5hbWUgPSBwYXRoLmJhc2VuYW1lKF9fZmlsZW5hbWUpO1xuY29uc3QgZW52ID0gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgfHwgJ2RldmVsb3BtZW50JztcbmNvbnN0IGNvbmZpZyA9IHJlcXVpcmUoX19kaXJuYW1lICsgJy8uLi9jb25maWcvY29uZmlnLmpzb24nKVtlbnZdO1xuY29uc3QgZGIgPSB7fTtcblxubGV0IHNlcXVlbGl6ZTtcbmlmIChjb25maWcudXNlX2Vudl92YXJpYWJsZSkge1xuICBzZXF1ZWxpemUgPSBuZXcgU2VxdWVsaXplKHByb2Nlc3MuZW52W2NvbmZpZy51c2VfZW52X3ZhcmlhYmxlXSwgY29uZmlnKTtcbn0gZWxzZSB7XG4gIHNlcXVlbGl6ZSA9IG5ldyBTZXF1ZWxpemUoY29uZmlnLmRhdGFiYXNlLCBjb25maWcudXNlcm5hbWUsIGNvbmZpZy5wYXNzd29yZCwgY29uZmlnKTtcbn1cblxuZnNcbiAgLnJlYWRkaXJTeW5jKF9fZGlybmFtZSlcbiAgLmZpbHRlcihmaWxlID0+IHtcbiAgICByZXR1cm4gKGZpbGUuaW5kZXhPZignLicpICE9PSAwKSAmJiAoZmlsZSAhPT0gYmFzZW5hbWUpICYmIChmaWxlLnNsaWNlKC0zKSA9PT0gJy5qcycpO1xuICB9KVxuICAuZm9yRWFjaChmaWxlID0+IHtcbiAgICBjb25zdCBtb2RlbCA9IHNlcXVlbGl6ZVsnaW1wb3J0J10ocGF0aC5qb2luKF9fZGlybmFtZSwgZmlsZSkpO1xuICAgIGRiW21vZGVsLm5hbWVdID0gbW9kZWw7XG4gIH0pO1xuXG5PYmplY3Qua2V5cyhkYikuZm9yRWFjaChtb2RlbE5hbWUgPT4ge1xuICBpZiAoZGJbbW9kZWxOYW1lXS5hc3NvY2lhdGUpIHtcbiAgICBkYlttb2RlbE5hbWVdLmFzc29jaWF0ZShkYik7XG4gIH1cbn0pO1xuXG5kYi5zZXF1ZWxpemUgPSBzZXF1ZWxpemU7XG5kYi5TZXF1ZWxpemUgPSBTZXF1ZWxpemU7XG5cbm1vZHVsZS5leHBvcnRzID0gZGI7XG4iXX0=