'use strict';

var fs = require('fs');
var path = require('path');
var Sequelize = require('sequelize');
var basename = path.basename(__filename);
var env = process.env.NODE_ENV || 'development';
var config = require(__dirname + '/../config/config.json')[env];
var db = {};

var sequelize = void 0;
if (config.use_env_variable) {
  sequelize = new Sequelize(process.env[config.use_env_variable], config);
} else {
  sequelize = new Sequelize(config.database, config.username, config.password, config);
}

fs.readdirSync(__dirname).filter(function (file) {
  return file.indexOf('.') !== 0 && file !== basename && file.slice(-3) === '.js';
}).forEach(function (file) {
  var model = sequelize['import'](path.join(__dirname, file));
  db[model.name] = model;
});

Object.keys(db).forEach(function (modelName) {
  if (db[modelName].associate) {
    db[modelName].associate(db);
  }
});

db.sequelize = sequelize;
db.Sequelize = Sequelize;

module.exports = db;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NlcnZlci9tb2RlbHMvaW5kZXguanMiXSwibmFtZXMiOlsiZnMiLCJyZXF1aXJlIiwicGF0aCIsIlNlcXVlbGl6ZSIsImJhc2VuYW1lIiwiX19maWxlbmFtZSIsImVudiIsInByb2Nlc3MiLCJOT0RFX0VOViIsImNvbmZpZyIsIl9fZGlybmFtZSIsImRiIiwic2VxdWVsaXplIiwidXNlX2Vudl92YXJpYWJsZSIsImRhdGFiYXNlIiwidXNlcm5hbWUiLCJwYXNzd29yZCIsInJlYWRkaXJTeW5jIiwiZmlsdGVyIiwiZmlsZSIsImluZGV4T2YiLCJzbGljZSIsImZvckVhY2giLCJtb2RlbCIsImpvaW4iLCJuYW1lIiwiT2JqZWN0Iiwia2V5cyIsIm1vZGVsTmFtZSIsImFzc29jaWF0ZSIsIm1vZHVsZSIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiJBQUFBOztBQUVBLElBQU1BLEtBQUtDLFFBQVEsSUFBUixDQUFYO0FBQ0EsSUFBTUMsT0FBT0QsUUFBUSxNQUFSLENBQWI7QUFDQSxJQUFNRSxZQUFZRixRQUFRLFdBQVIsQ0FBbEI7QUFDQSxJQUFNRyxXQUFXRixLQUFLRSxRQUFMLENBQWNDLFVBQWQsQ0FBakI7QUFDQSxJQUFNQyxNQUFNQyxRQUFRRCxHQUFSLENBQVlFLFFBQVosSUFBd0IsYUFBcEM7QUFDQSxJQUFNQyxTQUFTUixRQUFRUyxZQUFZLHdCQUFwQixFQUE4Q0osR0FBOUMsQ0FBZjtBQUNBLElBQU1LLEtBQUssRUFBWDs7QUFFQSxJQUFJQyxrQkFBSjtBQUNBLElBQUlILE9BQU9JLGdCQUFYLEVBQTZCO0FBQzNCRCxjQUFZLElBQUlULFNBQUosQ0FBY0ksUUFBUUQsR0FBUixDQUFZRyxPQUFPSSxnQkFBbkIsQ0FBZCxFQUFvREosTUFBcEQsQ0FBWjtBQUNELENBRkQsTUFFTztBQUNMRyxjQUFZLElBQUlULFNBQUosQ0FBY00sT0FBT0ssUUFBckIsRUFBK0JMLE9BQU9NLFFBQXRDLEVBQWdETixPQUFPTyxRQUF2RCxFQUFpRVAsTUFBakUsQ0FBWjtBQUNEOztBQUVEVCxHQUNHaUIsV0FESCxDQUNlUCxTQURmLEVBRUdRLE1BRkgsQ0FFVSxnQkFBUTtBQUNkLFNBQVFDLEtBQUtDLE9BQUwsQ0FBYSxHQUFiLE1BQXNCLENBQXZCLElBQThCRCxTQUFTZixRQUF2QyxJQUFxRGUsS0FBS0UsS0FBTCxDQUFXLENBQUMsQ0FBWixNQUFtQixLQUEvRTtBQUNELENBSkgsRUFLR0MsT0FMSCxDQUtXLGdCQUFRO0FBQ2YsTUFBTUMsUUFBUVgsVUFBVSxRQUFWLEVBQW9CVixLQUFLc0IsSUFBTCxDQUFVZCxTQUFWLEVBQXFCUyxJQUFyQixDQUFwQixDQUFkO0FBQ0FSLEtBQUdZLE1BQU1FLElBQVQsSUFBaUJGLEtBQWpCO0FBQ0QsQ0FSSDs7QUFVQUcsT0FBT0MsSUFBUCxDQUFZaEIsRUFBWixFQUFnQlcsT0FBaEIsQ0FBd0IscUJBQWE7QUFDbkMsTUFBSVgsR0FBR2lCLFNBQUgsRUFBY0MsU0FBbEIsRUFBNkI7QUFDM0JsQixPQUFHaUIsU0FBSCxFQUFjQyxTQUFkLENBQXdCbEIsRUFBeEI7QUFDRDtBQUNGLENBSkQ7O0FBTUFBLEdBQUdDLFNBQUgsR0FBZUEsU0FBZjtBQUNBRCxHQUFHUixTQUFILEdBQWVBLFNBQWY7O0FBRUEyQixPQUFPQyxPQUFQLEdBQWlCcEIsRUFBakIiLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG5cbmNvbnN0IGZzID0gcmVxdWlyZSgnZnMnKTtcbmNvbnN0IHBhdGggPSByZXF1aXJlKCdwYXRoJyk7XG5jb25zdCBTZXF1ZWxpemUgPSByZXF1aXJlKCdzZXF1ZWxpemUnKTtcbmNvbnN0IGJhc2VuYW1lID0gcGF0aC5iYXNlbmFtZShfX2ZpbGVuYW1lKTtcbmNvbnN0IGVudiA9IHByb2Nlc3MuZW52Lk5PREVfRU5WIHx8ICdkZXZlbG9wbWVudCc7XG5jb25zdCBjb25maWcgPSByZXF1aXJlKF9fZGlybmFtZSArICcvLi4vY29uZmlnL2NvbmZpZy5qc29uJylbZW52XTtcbmNvbnN0IGRiID0ge307XG5cbmxldCBzZXF1ZWxpemU7XG5pZiAoY29uZmlnLnVzZV9lbnZfdmFyaWFibGUpIHtcbiAgc2VxdWVsaXplID0gbmV3IFNlcXVlbGl6ZShwcm9jZXNzLmVudltjb25maWcudXNlX2Vudl92YXJpYWJsZV0sIGNvbmZpZyk7XG59IGVsc2Uge1xuICBzZXF1ZWxpemUgPSBuZXcgU2VxdWVsaXplKGNvbmZpZy5kYXRhYmFzZSwgY29uZmlnLnVzZXJuYW1lLCBjb25maWcucGFzc3dvcmQsIGNvbmZpZyk7XG59XG5cbmZzXG4gIC5yZWFkZGlyU3luYyhfX2Rpcm5hbWUpXG4gIC5maWx0ZXIoZmlsZSA9PiB7XG4gICAgcmV0dXJuIChmaWxlLmluZGV4T2YoJy4nKSAhPT0gMCkgJiYgKGZpbGUgIT09IGJhc2VuYW1lKSAmJiAoZmlsZS5zbGljZSgtMykgPT09ICcuanMnKTtcbiAgfSlcbiAgLmZvckVhY2goZmlsZSA9PiB7XG4gICAgY29uc3QgbW9kZWwgPSBzZXF1ZWxpemVbJ2ltcG9ydCddKHBhdGguam9pbihfX2Rpcm5hbWUsIGZpbGUpKTtcbiAgICBkYlttb2RlbC5uYW1lXSA9IG1vZGVsO1xuICB9KTtcblxuT2JqZWN0LmtleXMoZGIpLmZvckVhY2gobW9kZWxOYW1lID0+IHtcbiAgaWYgKGRiW21vZGVsTmFtZV0uYXNzb2NpYXRlKSB7XG4gICAgZGJbbW9kZWxOYW1lXS5hc3NvY2lhdGUoZGIpO1xuICB9XG59KTtcblxuZGIuc2VxdWVsaXplID0gc2VxdWVsaXplO1xuZGIuU2VxdWVsaXplID0gU2VxdWVsaXplO1xuXG5tb2R1bGUuZXhwb3J0cyA9IGRiO1xuIl19